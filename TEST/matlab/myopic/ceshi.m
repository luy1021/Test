%a1=2.16;a2=2.17;a3=2.16;a4=2.17;
a1=2.16;a2=2.17;a3=2.16;a4=2.17;
%b1=0.4;b2=0.2;b3=0.4;b4=0.6;
%b1=0.25;b2=0.28;b3=0.36;b4=0.34;600 601 602 603
%b1=0.26;b2=0.27;b3=0.36;b4=0.34;
b1=0.27;b2=0.26;b3=0.36;b4=0.34;
%r1=0.32;r2=0.31;r3=0.29;r4=0.31;
%r1=0.31;r2=0.33;r3=0.30;r4=0.32;
r1=0.31;r2=0.33;r3=0.30;r4=0.32;
C1=9;C2=9;C3=9;C4=9;
D1=2.02;D2=2.02;D3=2.02;D4=2.02;

x1=0;x2=0;x3=0;
x4=0;
theta=0.99;
%a1=1.15;a2=1.16;a3=1.12;b1=0.16;b2=0.25;b3=0.29;D1=2.06;D2=2.03;D3=2.03;r1=0.67;r2=0.78;r3=0.69;C1=9.99;C2=10.01;C3=10.00;

pp1=[];pp2=[];pp3=[];
pp4=[];
q1=[];q2=[];q3=[];
q4=[];
pi=[];
t=1;
while t<=12
f=@(x)(-(...
    (1/b1)*x(1)*(a1+r1*log(C1*x1+D1)-log(x(1))+log(1-x(1)-x(2)-x(3)-x(4)))+...
    (1/b2)*x(2)*(a2+r2*log(C2*x2+D2)-log(x(2))+log(1-x(1)-x(2)-x(3)-x(4)))+...
    (1/b3)*x(3)*(a3+r3*log(C3*x3+D3)-log(x(3))+log(1-x(1)-x(2)-x(3)-x(4)))+...
    (1/b4)*x(4)*(a4+r4*log(C4*x4+D4)-log(x(4))+log(1-x(1)-x(2)-x(3)-x(4)))...
    ));
x0=[0.01;0.01;0.01;0.01];
lb=[0;0;0;0];
ub=[1;1;1;1];
[xx1,fval1] = fmincon(f,x0,[],[],[],[],lb,ub);
p1=(1/b1)*(a1-log(xx1(1))+log(1-xx1(1)-xx1(2)-xx1(3)-xx1(4))+r1*log(C1*x1+D1))
p2=(1/b2)*(a2-log(xx1(2))+log(1-xx1(1)-xx1(2)-xx1(3)-xx1(4))+r2*log(C2*x2+D2))
p3=(1/b3)*(a3-log(xx1(3))+log(1-xx1(1)-xx1(2)-xx1(3)-xx1(4))+r3*log(C3*x3+D3))
p4=(1/b4)*(a4-log(xx1(4))+log(1-xx1(1)-xx1(2)-xx1(3)-xx1(4))+r4*log(C4*x4+D4))
x1 = xx1(1) 
x2 = xx1(2) 
x3 = xx1(3)
x4 = xx1(4)
%pi1=p1*xx1(1)+p2*xx1(2)+p3*xx1(3)
pi1 = -fval1 
pp1=[pp1 p1]
pp2=[pp2 p2]
pp3=[pp3 p3]
pp4=[pp4 p4]
q1=[q1 xx1(1)]
q2=[q2 xx1(2)]
q3=[q3 xx1(3)]
q4=[q4 xx1(4)]
pi=[pi pi1]
t=t+1
end
